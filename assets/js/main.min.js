document.addEventListener("DOMContentLoaded",()=>{$getUsers("div.room").catch(console.error),$formControl("form.room-kick"),$formControl("form.user-kick"),$urlControl(".core-power")});const $getUsers=async e=>{const t=document.querySelectorAll(e),n=t.length;for(let e=0;e<n;++e){const s=t[e].dataset.room,o=document.getElementById(`users-${s}`),i=`user.list.php?room=${s}`;setInterval(async function(){const e=await fetch(i,{cache:"no-cache",headers:{"Cache-Control":"no-cache"}});o.innerHTML=await e.text()},1e3)}},$formControl=e=>{const t=document.querySelectorAll(e),n=t.length;for(let e=0;e<n;++e)t[e].addEventListener("submit",function(e){const t=this,n=t.getAttribute("action"),s=t.getAttribute("method"),o=new FormData(t),i=t.querySelector('button[type="submit"]');fetch(n,{method:s,body:o}).then(e=>e.text()),$_lockUnlock(i),e.preventDefault()})},$urlControl=e=>{const t=document.querySelectorAll(e),n=t.length;for(let e=0;e<n;++e)t[e].addEventListener("click",function(e){const t=this,n=t.getAttribute("href");fetch(n).then(e=>e.text()),e.preventDefault()})},$_lockUnlock=e=>{const t=e.querySelector("i"),n=t.className;e.disabled=!0,t.className="fas fa-cog fa-spin fa-fw",setTimeout(function(){e.disabled=!1,t.className=n},5e3)}
